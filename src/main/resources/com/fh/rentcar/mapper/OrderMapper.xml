<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.fh.rentcar.mapper.OrderMapper">
    <resultMap id="orderMap" type="com.fh.rentcar.pojo.OrderDetail">
        <id column="id" property="id" />
        <association property="car" column="car_id"
                     javaType="com.fh.rentcar.pojo.Cars" select="MapToCar"/>
        <association property="shop" column="shop_id"
                     javaType="com.fh.rentcar.pojo.Shops" select="MapToShops"/>
        <association property="user" column="uid"
                     javaType="com.fh.rentcar.pojo.User" select="MapToUser"/>
    </resultMap>

    <select id="getAllOrder" resultMap="orderMap">
         select * from order_details
    </select>



    <select id="updateOrder" parameterType="java.util.Map">
        update order_details
        <set>
            <if test="orderstatus != null">
                orderstatus=#{orderstatus},
            </if>
            <if test="uid != null">
                uid=#{uid},
            </if>
            <if test="returnaddress != null">
                returnaddress=#{returnaddress},
            </if>
            <if test="contractimg != null">
                contractimg=#{contractimg},
            </if>
        </set>
        where id = #{id}
    </select>

    <insert id="addOrder" parameterType="com.fh.rentcar.pojo.OrderDetail">
        insert into
        order_details(car_id,pickcartime,returncartime,pickaddress,shop_id,renttime,uid,rentprice,deposit,rentfrom,renttype,ordertime,orderstatus)
        values (#{car_id},#{pickcartime},#{returncartime},#{pickaddress},#{shop_id},#{renttime},#{uid},#{rentprice},#{deposit},#{rentfrom},#{renttype},#{ordertime},#{orderstatus})
    </insert>


    <select id="MapToCar" resultType="com.fh.rentcar.pojo.Cars">
        select * from carlist where id = #{car_id};
    </select>
    <select id="MapToShops" resultType="com.fh.rentcar.pojo.Shops">
        select * from shops where id = #{shop_id}
    </select>
    <select id="MapToUser" resultType="com.fh.rentcar.pojo.User">
        select * from user_info where id = #{uid}
    </select>
</mapper>